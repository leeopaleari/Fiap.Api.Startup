-- TABELAS
CREATE TABLE T_USUARIO (
--id                integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL PRIMARY KEY,
  id                NUMBER  PRIMARY KEY,
  nome              VARCHAR2(20) NOT NULL,
  sobrenome         VARCHAR2(40) NOT NULL, 
  email             VARCHAR2(100) UNIQUE NOT NULL,
  data_nascimento   DATE,
  celular           VARCHAR2(15),
  senha             VARCHAR2(50) NOT NULL,
  documento         VARCHAR(13) UNIQUE NOT NULL
);
  
CREATE SEQUENCE USUARIO_ID_SEQ;  

CREATE OR REPLACE TRIGGER TR_SEQ_USUARIO BEFORE INSERT ON T_USUARIO FOR EACH ROW  
BEGIN 
	SELECT USUARIO_ID_SEQ.NEXTVAL INTO :new.ID FROM dual; 
END;

--DROP TRIGGER TR_SEQ_USUARIO; 
--DROP SEQUENCE USUARIO_ID_SEQ; 
--DROP TABLE T_USUARIO CASCADE CONSTRAINTS; 

CREATE TABLE T_ENDERECO (
--  id              integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL PRIMARY KEY,
    id              NUMBER  PRIMARY KEY,
    logradouro      VARCHAR2(255) NOT NULL,
    bairro          VARCHAR2(100) NOT NULL,
    cidade          VARCHAR2(100) NOT NULL,
    estado          VARCHAR2(2)   NOT NULL,
    complemento     VARCHAR2(100),
    numero          VARCHAR2(10) NOT NULL,
    cep             VARCHAR2(9) NOT NULL,
    t_usuario_id    NUMBER  NOT NULL,
    CONSTRAINT fk_usuario_endereco FOREIGN KEY (t_usuario_id) REFERENCES T_USUARIO(id)
);

CREATE SEQUENCE ENDERECO_ID_SEQ;

CREATE OR REPLACE TRIGGER TR_SEQ_ENDERECO BEFORE INSERT ON T_ENDERECO FOR EACH ROW  
BEGIN 
	SELECT ENDERECO_ID_SEQ.NEXTVAL INTO :new.ID FROM dual; 
END; 


--DROP TRIGGER TR_SEQ_ENDERECO; 
--DROP SEQUENCE ENDERECO_ID_SEQ; 
--DROP TABLE T_ENDERECO CASCADE CONSTRAINTS; 

CREATE TABLE T_VEICULO (
    id              NUMBER PRIMARY KEY,
    marca           VARCHAR2(20) NOT NULL,
    modelo          VARCHAR2(30) NOT NULL,
    placa           VARCHAR2(8) NOT NULL,
    quilometragem   NUMBER,
    ano_modelo      NUMBER  NOT NULL,
    ano_fabricacao  NUMBER NOT NULL
);

CREATE SEQUENCE VEICULO_ID_SEQ;

CREATE OR REPLACE TRIGGER TR_SEQ_VEICULO BEFORE INSERT ON T_VEICULO FOR EACH ROW  
BEGIN 
	SELECT VEICULO_ID_SEQ.NEXTVAL INTO :new.ID FROM dual; 
END; 

--DROP TRIGGER TR_SEQ_VEICULO; 
--DROP SEQUENCE VEICULO_ID_SEQ; 
--DROP TABLE T_VEICULO CASCADE CONSTRAINTS;

